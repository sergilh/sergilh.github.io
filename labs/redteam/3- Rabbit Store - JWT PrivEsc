üê∞ Rabbit Store ‚Äì JWT Abuse, SSTI & Privilege Escalation
Objetivo:
 Comprometer la m√°quina y obtener acceso root.
Enumeraci√≥n:
 Realic√© escaneo con Nmap y configur√© los dominios:
cloudsite.thm


storage.cloudsite.thm


Tras registrarme como usuario normal, el acceso estaba muy limitado.
JWT Manipulation:
 Intercept√© la petici√≥n de login con Burp Suite y analic√© el JWT. Al decodificarlo, encontr√© el campo:
subscription: inactive

Intent√© modificarlo sin √©xito en el login, pero al interceptar la petici√≥n de registro, a√±ad√≠:
subscription: active

Esto me permiti√≥ crear un usuario con acceso al dashboard activo.
File Upload & SSRF:
 El panel permit√≠a subir archivos. Sub√≠ una shell.php y el sistema confirm√≥ la subida, pero al acceder a la ruta devolv√≠a un error JSON indicando que el archivo no exist√≠a.
Enumer√© /api con Gobuster y encontr√© m√∫ltiples rutas restringidas. Prob√© subir archivos desde una fuente externa usando:
python3 -m http.server 8000

El servidor permit√≠a leer archivos internos, como index.html.
API Abuse & SSTI:
 Detect√© que la aplicaci√≥n usaba Express.js en el puerto 3000. Acced√≠ a:
http://localhost:3000/api/docs

Dentro encontr√© el endpoint:
/api/fetch_messages_from_chatbot

Cambi√© la petici√≥n de GET a POST, ajust√© las cabeceras y obtuve un error indicando que faltaba el par√°metro username. Aprovech√© esto para explotar una Server-Side Template Injection, lo que me permiti√≥ ejecutar comandos y obtener una shell.
Escalada de privilegios:
 Encontr√© user.txt y una Erlang cookie en /var/lib/rabbit. Usando Metasploit obtuve acceso al sistema RabbitMQ. Tras modificar permisos y exportar definiciones, consegu√≠ un archivo JSON con hashes de usuarios.
Decodificando la contrase√±a del usuario root (Base64 ‚Üí hex), logr√© escalar privilegios y acceder a root.txt.
