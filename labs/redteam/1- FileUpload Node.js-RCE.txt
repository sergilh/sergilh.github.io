üîê Challenge Final ‚Äì File Upload & Node.js RCE
Objetivo:
 Comprometer la m√°quina objetivo obteniendo una shell y localizar la flag final.
Enumeraci√≥n inicial:
 El dominio proporcionado era jewel.upload vulns.thm. Al acceder a la web se mostraba un formulario de subida de archivos. Inspeccionando el c√≥digo fuente observ√© que el filtrado de archivos se realizaba desde el lado del cliente, concretamente en un archivo JavaScript (upload.js).
Bypass de filtros:
 Us√© Burp Suite para interceptar las peticiones, pero inicialmente no se mostraban los archivos .js. Para solucionarlo, ajust√© la configuraci√≥n del interceptor eliminando la extensi√≥n .js del filtrado. Adem√°s, la cach√© del navegador imped√≠a modificar la respuesta del script, por lo que tuve que eliminar manualmente las cabeceras de cach√© desde la request.
Una vez modificado el script, elimin√© el filtrado de extensiones.
Enumeraci√≥n de directorios:
 Antes de subir la shell realic√© un escaneo con Gobuster usando el wordlist proporcionado por el ejercicio. Aparecieron rutas como:
/admin


/content


Al enumerar /admin, observ√© mediante el header X-Powered-By que la aplicaci√≥n utilizaba Node.js, lo que indicaba que la shell deb√≠a estar adaptada a este entorno.
Obtenci√≥n de shell:
 Cre√© una shell en Node.js (shell.js) y la renombr√© a shell.js.jpg, ya que el sistema solo permit√≠a archivos JPG. Tras desactivar el interceptor y subir el archivo, no era posible ejecutarlo directamente desde la barra de direcciones, ya que el panel de administraci√≥n solo ejecutaba m√≥dulos espec√≠ficos.
Las rutas /modules y /content se encontraban en el mismo nivel, por lo que utilic√© path traversal (../content/archivo.jpg) para acceder al archivo subido.
Probando manualmente las im√°genes detectadas por Gobuster dentro de /content, una de ellas devolvi√≥ un error que permiti√≥ ejecutar la shell y obtener acceso a la terminal.
Flag:
 Desde la shell navegu√© hasta /var/www/ donde encontr√© el archivo FLAG.TXT, completando el desaf√≠o.

üß™ Pickle Rick ‚Äì Command Injection & Privilege Escalation
Objetivo:
 Ayudar a Rick obteniendo los tres ingredientes ocultos en el sistema.
Enumeraci√≥n:
 Asign√© el dominio picklerick.thm en /etc/hosts. Al acceder a la web, Rick dejaba mensajes indicando que necesitaba ayuda para recuperar los ingredientes.
Inspeccionando el c√≥digo HTML encontr√© un comentario con el usuario:
R1ckRul3s

Realic√© enumeraci√≥n de directorios con Gobuster (inicialmente olvid√© usar -x php,txt, lo que retras√≥ el proceso). Una vez corregido, encontr√© acceso a:
/robots.txt ‚Üí conten√≠a Wubbalubbadubdub


/login


/portal.html


Prob√© las credenciales encontradas y consegu√≠ acceso al portal.
Command Injection:
 Dentro del portal hab√≠a un input llamado commands, el cual ejecutaba comandos directamente en el sistema. Prob√© comandos b√°sicos como:
whoami
pwd
ls

Ingredientes:
Primer ingrediente: ubicado en el directorio actual. No pod√≠a leerse con cat, as√≠ que utilic√© less.


Segundo ingrediente: localizado en /home/rick. El nombre del archivo conten√≠a espacios, por lo que utilic√© nl para leerlo.


Tercer ingrediente: dentro del directorio /root. Al ejecutar sudo -l, comprob√© que el usuario ten√≠a permisos totales. Usando sudo ls pude listar el contenido y obtener el √∫ltimo ingrediente.


Con esto finalic√© el reto.
